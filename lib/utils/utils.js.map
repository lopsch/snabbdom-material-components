{"version":3,"sources":["../../src/utils/utils.js"],"names":["delayInit","uuid","makeHooks","makeSelector","makeKeyValue","elm","callback","delay","pos","window","getComputedStyle","position","pollId","setInterval","poll","clearInterval","_uuid","a","Math","random","toString","replace","Adapter","hooks","insert","vnode","material","data","postpatch","oldVnode","callHook","update","arguments","destroy","hook","Array","prototype","slice","call","id","selector","key","value","PropsNormalizer","props","switches","fromClassNames","_classes","_fromClassNames","fromStyle","fromProps","fromSwitches","_fromSwitches","_allClasses","extractedClasses","i","length","_class","normalizedProps","map","_switch","classes","classNames","className","split"],"mappings":"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","file":"utils.js","sourcesContent":["import { style as css } from 'typestyle'\nimport { tryFlatten } from 'snabbdom-jsx-pragma'\n\nexport function delayInit (elm, callback, delay = 100) {\n  let pos = window.getComputedStyle(elm).position\n\n  if (pos === 'relative') {\n    callback()\n  } else {\n    let pollId = 0\n\n    pollId = window.setInterval(function poll () {\n      pos = window.getComputedStyle(elm).position\n\n      if (pos === 'relative') {\n        window.clearInterval(pollId)\n        callback()\n      }\n    }, delay)\n  }\n}\n\nexport function uuid () {\n  return _uuid()\n}\n\n/* eslint-disable operator-linebreak */\nfunction _uuid (\n  a // placeholder\n) {\n  return a // if the placeholder was passed, return\n    ? // a random number from 0 to 15\n    (a ^ // unless b is 8,\n        ((Math.random() * // in which case\n          16) >> // a random number from\n          (a / 4))) // 8 to 11\n      .toString(16) // in hexadecimal\n    : // or otherwise a concatenated string:\n    ([1e7] + // 10000000 +\n      -1e3 + // -1000 +\n      -4e3 + // -4000 +\n      -8e3 + // -80000000 +\n        -1e11) // -100000000000,\n      .replace(\n        // replacing\n        /[018]/g, // zeroes, ones, and eights with\n        _uuid // random hex digits\n      )\n}\n\nexport function makeHooks (Adapter) {\n  const hooks = {}\n\n  hooks.insert = function insert (vnode) {\n    const material = new Adapter(vnode)\n    vnode.data.material = material\n  }\n\n  hooks.postpatch = function postpatch (oldVnode, vnode) {\n    vnode.data.material = oldVnode.data.material\n    callHook(vnode.data.material.update, ...arguments)\n  }\n\n  hooks.destroy = function destroy (vnode) {\n    callHook(vnode.data.material.destroy, ...arguments)\n  }\n\n  return hooks\n\n  function callHook (hook) {\n    if (typeof hook === 'function') {\n      hook(...Array.prototype.slice.call(arguments, 1))\n    }\n  }\n}\n\nexport function makeSelector (id) {\n  return id && id !== '' ? { selector: `#${id}` } : {}\n}\n\nexport function makeKeyValue (key, value) {\n  return value && value !== '' ? { [key]: value } : {}\n}\n\nexport class PropsNormalizer {\n  constructor (props, switches) {\n    props = props || {}\n    switches = switches || {}\n\n    const fromClassNames =\n      props && props['classNames']\n        ? this._classes(this._fromClassNames([props['classNames']]))\n        : {}\n    const fromStyle =\n      props && props['style']\n        ? this._classes(this._fromClassNames([css(props['style'])]))\n        : {}\n    const fromProps = props && props['class'] ? props['class'] : {}\n    const fromSwitches =\n      switches && props ? this._fromSwitches(switches, props) : {}\n\n    const _allClasses = [fromClassNames, fromStyle, fromProps, fromSwitches]\n    this.extractedClasses = {}\n\n    for (let i = 0; i < _allClasses.length; i++) {\n      const _classes = _allClasses[i]\n\n      for (let _class in _classes) {\n        this.extractedClasses[_class] = _classes[_class]\n      }\n    }\n\n    this.normalizedProps = props\n    delete this.normalizedProps['classNames']\n    delete this.normalizedProps['style']\n    delete this.normalizedProps['class']\n  }\n\n  get normalized () {\n    return { classes: this.extractedClasses, props: this.normalizedProps }\n  }\n\n  _fromSwitches (switches, props) {\n    const map = {}\n\n    for (let _switch in switches) {\n      map[switches[_switch]] = !!props[_switch]\n    }\n\n    return map\n  }\n\n  _classes (classes) {\n    const map = {}\n\n    for (let i = 0; i < classes.length; i++) {\n      map[classes[i]] = true\n    }\n\n    return map\n  }\n\n  _fromClassNames (classNames) {\n    return tryFlatten(\n      tryFlatten(classNames).map(className =>\n        className.replace(/\\s+/g, '_§§§_').split('_§§§_')\n      )\n    )\n  }\n}\n"]}